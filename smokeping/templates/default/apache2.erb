# Smokeping Apache Virtual Host
#
# Generated by Chef
<VirtualHost *:<%= node['smokeping']['port'] %>>
  <% if node['smokeping']['admin_email'] %>ServerAdmin     <%= node['smokeping']['admin_email'] %><% end %>
  ServerName      <%= node['smokeping']['server_name'] %>
  <% if node['smokeping']['server_alias'] %>ServerAlias     <%= node['smokeping']['server_alias'] %><% end %>

  DocumentRoot /var/www

  RewriteEngine on
  RewriteCond %{REQUEST_URI} !smokeping\.cgi
  RewriteCond %{REQUEST_URI} !images
  RewriteRule ^(.*)$ /smokeping.cgi [R=301]

  Alias /smokeping /usr/share/smokeping/www
  <Directory "/usr/share/smokeping/www">
      Options FollowSymLinks
  </Directory>

  <Location />
    AuthName "Smokeping Server"
  </Location>

  ScriptAlias / /usr/lib/cgi-bin/
  <Directory "/usr/lib/cgi-bin">
    AllowOverride None
    Options ExecCGI -MultiViews +SymLinksIfOwnerMatch
    Order allow,deny
    Allow from all
  </Directory>

</VirtualHost>

